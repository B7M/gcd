In previous lessons we talked a bit about tidy data and the qualities that define it. This next week of lessons will be devoted to how to tidy your data - starting here with how to reshape your data. Tidy data generally exist in two forms: wide data and long data. Both types of data are used and needed in data analysis, and fortunately, there are tools that can take you from wide-to-long and from long-to-wide. This makes it easy to work with any tidy dataset. We'll discuss the basics of what wide and long data are and how to go back and forth between the two in R.. Getting data into the right format will be crucial when summarizing and visualizing it.

Wide data has a column for each variable and a row for each observation. Data are often entered and stored in this manner. This is because wide data are often easy to understand at a glance. For example, this is a wide data set. Here you can clearly see what measurements were taken for each individual and can get a sense of how many individuals are contained in the dataset. Specifically, each individual is in a different row with each variable in a different column. At a glance we can quickly see that we have information about four different people and that each person was measured in four different ways. 

Long data, on the other hand, has one column indicating the type of variable contained in that row and then a separate row for the value for that variable. Each row contains a single observation for a single variable.  This is an example of a long data set. This long dataset includes the exact same information as the previous wide dataset; it is just stored differently. It's harder to see visually how many different measurements were taken and on how many different people, but the same information is there. While long data formats are less human readable than wide data at a glance, they are a lot easier to work with during analysis. Most of the tools we'll be working with use long data. Thus, to go from how data are often stored (wide) to working with the data during analysis (long), we'll need to understand what tools are needed to do this and how to work with them.

Converting your data from wide-to-long or from long-to-wide data formats is referred to as reshaping your data. There are two primary packages in R that will help you reshape your data: tidy R and reshape 2. We'll walk through the important functions of these two packages and work through a few examples using the functions in each. However, as with most helpful packages in R, there is more functionality than what is discussed here, so feel free to explore the additional resources at the end of the lesson to learn even more.

For these examples, we'll work with the air quality dataset available in R. The data in this dataset includes "Daily air quality measurements in New York, May to September 1973." This is a wide dataset because each day is in a separate row and there are multiple columns with each including information about a different variable (ozone, solar dot R, wind, temp, month, and day). We can see the first few lines of this dataset using head. Again, wide data are easy to decipher at a glance. We can see that we have six different variables for each day, with each one of these variables (measurements) being stored in a separate column.

Within tidy R, there are two functions to help you reshape your data. The first is gather, which goes from wide data to long data. The other is spread, which goes from long data to wide data. To get started, you'll need to be sure that the tidy R package is installed and loaded into your R Studio session.

As data are often stored in wide formats, you'll likely use gather far more frequently than you'll use spread. This will allow you to get the data into a long format that will be easy to use for analysis. In tidy R, gather will take the air quality dataset from wide to long, putting each column name into the first column and each corresponding value into the second column. 

Here, the first column will be called key. The second column will be value. First, use gather to reshape from wide to long and then use head to take a look at first few rows of long data

It's very easy to change the names of these columns within gather. To do so you define what the key and value columns names should be within gather. To rename the column names that gather provides, you change the options key and value to what you want those column names to be (in this case, variable and value).

However, you're likely not interested in your day and month variable being separated out into their own variables within the key column. In fact, knowing the day and month associated with a particular data point helps identify that particular data point. To account for this, you can exclude day and month from the variables being included in the key column by specifying all the variables that you do want included in the key column.  Here, that means specifying ozone, solar dot R, wind, and temp. This will keep day and month in their own columns, allowing each row to be identified by the specific day and month being discussed. Now, when you look at the top of this object, you'll see that month and day remain in the data frame and that variable combines information from the other columns in airquality (ozone, solar dot R, wind, temp). This is still a long format dataset; however, it has used month and day as IDs when reshaping the data frame.

To return your long data back to its original form, you can use spread. Here you specify two columns: the column that contains the names of what your wide data columns should be (here key equals variable) and the column that contains the values that should go in these columns (value equals value). 

The data frame resulting from spread will have the original information back in the wide format (again, the columns will be in a different order). But, we'll discuss how to rearrange data in a later lesson!

As with many things in R, there is more than one way to solve a problem. While tidy R provides a more general solution for reshaping data, reshape 2 was specifically designed for reshaping data. The details aren't particularly important yet, but later on as you carry out your own analyses it will be good to know about both packages. To get started using reshape 2, you'll have to first install the library and load it into your R session.

There are two main functions within the reshape 2 package: one is melt, which goes from wide data to long data, and the other is  D cast which goes from long data to wide data. The melt function, like gather, will allow you to get the data into a long format that will be easy to use for analysis. When you melt a dataset with the default options, melt will take every column, take the column name put it into a variable column, and then put the values of those variables into a value column. For the airquality data set, below we first assign the melted data frame to the object melted. Then we take a look at the top (head) and bottom (tail) of this melted data frame. 

When you run this code you see that each column from the original data frame (ozone, solar dot R, wind, temp, month, and day) are now repeated in the variables column, and each day's value for that variable is now in the value column. This is now a long format dataset!

Now, to use month and day as identifiers as we did with tidy R's gather above, the approach is slightly different. With gather, you specified the column names that you wanted to gather and omitted the column names that you wanted to retain as identifiers. With melt you will do the opposite. You will specify day and month as identifiers for the dataset and omit the remaining variables. 

Despite the slight change in how the code was specified, the result here using melt is the same as what was achieved above using gather.

You'll likely have to go from long-to-short format less frequently; however, it's good to know there are two approaches to accomplishing this within reshape2 whenever it is necessary. The first is A cast which takes a long frame and returns a matrix, array, or vector. The second is D cast which takes a long frame and returns it to a data frame. To return our melted data back into its original wide form, we'll use dcast. The syntax here separates what should be used as an identifier for each row in the resulting wide format (month plus day) and which column includes the values that should be the column headers (variable). These two pieces of information are separated by a tilde.

As you can see, aside from the column order changing, the information in original is the same as what was in the data frame we started with.

While reshaping data may not be the most exciting topic, having this skill will be indispensable as you start working with data. It's best to get these skills down early! In this lesson, we looked at two packages for reshaping data: tidy R and reshape 2. Both have similar functions for changing your datasets from wide to long and long to wide! 